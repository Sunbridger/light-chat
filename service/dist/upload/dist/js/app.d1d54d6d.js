(function(e){function t(t){for(var r,i,s=t[0],c=t[1],u=t[2],f=0,d=[];f<s.length;f++)i=s[f],a[i]&&d.push(a[i][0]),a[i]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(e[r]=c[r]);l&&l(t);while(d.length)d.shift()();return o.push.apply(o,u||[]),n()}function n(){for(var e,t=0;t<o.length;t++){for(var n=o[t],r=!0,s=1;s<n.length;s++){var c=n[s];0!==a[c]&&(r=!1)}r&&(o.splice(t--,1),e=i(i.s=n[0]))}return e}var r={},a={app:0},o=[];function i(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=e,i.c=r,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(n,r,function(t){return e[t]}.bind(null,r));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="dist/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],c=s.push.bind(s);s.push=t,s=s.slice();for(var u=0;u<s.length;u++)t(s[u]);var l=c;o.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("cd49")},1:function(e,t){},"355d2":function(e,t,n){},"3bb5":function(e,t,n){"use strict";var r=n("355d2"),a=n.n(r);a.a},"41a6":function(e,t,n){},"5c48":function(e,t,n){},"66c0":function(e,t,n){"use strict";var r=n("c0c8"),a=n.n(r);a.a},"7c55":function(e,t,n){"use strict";var r=n("5c48"),a=n.n(r);a.a},c0c8:function(e,t,n){},cd49:function(e,t,n){"use strict";n.r(t);n("cadf"),n("551c"),n("f751"),n("097d");var r=n("2b0e"),a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("router-view")],1)},o=[],i=(n("8e6e"),n("ac6a"),n("456d"),n("bd86")),s=(n("7f7f"),n("bc3a")),c=n.n(s),u=n("8055"),l=n.n(u),f=l()("wss://2261295nz5.51mypc.cn"),d="https://2261295nz5.51mypc.cn",m=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return c.a.post(d+e,t)},p=function(e,t,n){f.emit(e,t,n)},h=function(e,t){f.on(e,t)},g=n("2f62");function v(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function b(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?v(n,!0).forEach(function(t){Object(i["a"])(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):v(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var w={data:function(){return{audioCtx:new AudioContext}},created:function(){var e=this,t=window.localStorage.uid;t&&h("receive-private-chat",function(n){if(e.audioTip(),"chat"!==e.$route.name){var r=t+"-"+n.uid,a=e.getStroage(r)||0;a&&null!=a?e.$message({message:"".concat(n.name,"发来一条新消息"),type:"success"}):(e.saveStroage(Object(i["a"])({},r,++a)),location.reload())}else e.getShouldShowMsg({uid1:t,uid2:n.uid}),window.scrollTo({top:window.screen.height+9999,behavior:"smooth"})})},computed:{},methods:b({},Object(g["b"])(["getShouldShowMsg"]),{audioTip:function(){var e=this.audioCtx,t=e.createOscillator(),n=e.createGain();t.connect(n),n.connect(e.destination),t.type="sine",t.frequency.value=600,n.gain.setValueAtTime(0,e.currentTime),n.gain.linearRampToValueAtTime(2,e.currentTime+.01),t.start(e.currentTime),n.gain.exponentialRampToValueAtTime(.001,e.currentTime+1),t.stop(e.currentTime+1)}})},y=w,O=(n("7c55"),n("2877")),S=Object(O["a"])(y,a,o,!1,null,null,null),j=S.exports,x=n("8c4f"),_=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"pg-login"},[n("el-form",{ref:"form",attrs:{model:e.form,"label-width":"60px"}},[n("el-form-item",{attrs:{label:"账号"}},[n("el-input",{model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),n("el-form-item",{attrs:{label:"密码"}},[n("el-input",{attrs:{type:"password"},model:{value:e.form.password,callback:function(t){e.$set(e.form,"password",t)},expression:"form.password"}})],1),n("el-form-item",[n("el-button",{attrs:{type:"success"},on:{click:e.login}},[e._v("登陆")]),n("el-button",{attrs:{type:"primary"}},[n("router-link",{attrs:{to:{name:"register"}}},[e._v("注册")])],1)],1)],1)],1)},P=[],k="https://2261295nz5.51mypc.cn/",$=k,C={name:"login",data:function(){return{form:{name:"",password:""}}},methods:{login:function(){var e=this;this.form.name.trim()&&this.form.password.trim()?m("/login",this.form).then(function(t){var n=t.data;if(n.status){var r=n.uid,a=n.avatar,o=n.name;e.saveStroage({uid:r,avatar:a,name:o}),e.$router.push({name:"home"})}else e.$message({message:n.msg,type:"error",duration:1500})}):this.$message({message:"请填写账号或密码",type:"warning",duration:1500})}}},M=C,T=(n("66c0"),Object(O["a"])(M,_,P,!1,null,null,null)),E=T.exports,N=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"pg-form"},[n("el-form",{ref:"form",attrs:{model:e.form,"label-width":"60px",rules:e.rules}},[n("el-form-item",{attrs:{label:"账号",prop:"name"}},[n("el-input",{model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),n("el-form-item",{attrs:{label:"密码",prop:"password"}},[n("el-input",{attrs:{type:"password"},model:{value:e.form.password,callback:function(t){e.$set(e.form,"password",t)},expression:"form.password"}})],1),n("el-form-item",{attrs:{label:"头像"}},[n("el-upload",{staticClass:"avatar-uploader",attrs:{action:e.serviceImg,"show-file-list":!1,"on-success":e.handleAvatarSuccess,"before-upload":e.beforeAvatarUpload}},[e.urlImg?n("img",{staticClass:"avatar",attrs:{src:e.urlImg}}):n("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1),n("el-form-item",[n("el-button",{directives:[{name:"loading",rawName:"v-loading.fullscreen.lock",value:e.fullscreenLoading,expression:"fullscreenLoading",modifiers:{fullscreen:!0,lock:!0}}],attrs:{type:"primary",plain:""},on:{click:function(t){return e.onRegister("form")}}},[e._v("提交")])],1)],1)],1)},A=[],D=$+"addimg",F={name:"register",data:function(){return{form:{name:"",password:"",avatar:""},rules:{name:[{required:!0,message:"请输入账号名称",trigger:"blur"},{min:3,max:10,message:"长度在 3 到 10 个字符",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}]},urlImg:"",fullscreenLoading:!1,serviceImg:D}},methods:{onRegister:function(e){var t=this;this.$refs[e].validate(function(e){e?t.registerFn():t.$message({message:"请按要求填写信息",type:"warning",duration:1500})})},registerFn:function(){var e=this;m("/register",this.form).then(function(t){var n=t.data;e.fullscreenLoading=!1,n.msg?(e.$message({message:"注册成功",type:"success",duration:450}),e.$router.push({name:"login"})):e.$message({message:"用户名已存在",type:"error",duration:1500})})},handleAvatarSuccess:function(e,t){this.form.avatar=this.service+e.url,this.urlImg=URL.createObjectURL(t.raw)},beforeAvatarUpload:function(e){var t="image/jpeg"===e.type||"image/png",n=e.size/1024/1024<2;return t||this.$message.error("只支持jpeg|png格式图片"),n||this.$message.error("上传头像图片大小不能超过 2MB!"),t&&n}}},R=F,U=(n("ddb4"),Object(O["a"])(R,N,A,!1,null,null,null)),I=U.exports,z=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("div",{staticClass:"fix-top"},[n("i",{staticClass:"el-icon-arrow-left",on:{click:e.goBack}}),e._v("\n        "+e._s(e.friend.name)+"\n    ")]),n("div",{staticClass:"content-top"},e._l(e.shouldShowMsg,function(t){return n("div",{key:t.id,staticClass:"row-msg"},[n("p",{staticClass:"top-msg",class:{fr:e.byme(t.fromuid),fl:!e.byme(t.fromuid)}},[t.loading&&e.byme(t.fromuid)?n("i",{staticClass:"el-icon-loading"}):e._e(),e._v("\n                "+e._s(t.msg)+"\n                "),n("el-avatar",{class:{"el-avatar-fl":!e.byme(t.fromuid),"el-avatar-fr":e.byme(t.fromuid)},attrs:{src:e.byme(t.fromuid)?e.myAvatar:e.friend.avatar}})],1)])}),0),n("div",{staticClass:"box-chat"},[n("el-input",{attrs:{type:"textarea",autosize:{minRows:1,maxRows:4}},model:{value:e.content,callback:function(t){e.content=t},expression:"content"}}),n("el-button",{attrs:{size:"small",type:"success",round:""},on:{click:e.submit}},[e._v("发送")])],1)])},L=[];function B(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function q(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?B(n,!0).forEach(function(t){Object(i["a"])(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):B(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var V={name:"chat",data:function(){return{content:"",friend:this.$route.params,myAvatar:this.getStroage("avatar"),myName:this.getStroage("name"),myUid:this.getStroage("uid")}},computed:{shouldShowMsg:function(){return this.$store.state.shouldShowMsg}},created:function(){this.getmsgoto(),this.clearNum()},methods:q({},Object(g["b"])(["getShouldShowMsg"]),{},Object(g["c"])(["changeShouldShowMsg"]),{clearNum:function(){var e=this.myUid+"-"+this.friend.uid;window.localStorage.removeItem(e)},getmsgoto:function(){this.getShouldShowMsg({uid1:this.myUid,uid2:this.friend.uid})},byme:function(e){return e==this.myUid},submit:function(){var e=this;if(this.content){var t=this.content;this.content="";var n={uid:this.myUid,msg:t,name:this.myName};this.changeShouldShowMsg({fromuid:this.myUid,avatar:this.avatar,msg:t,loading:!0}),this.autoBottom(),m("/savemsg",{from:this.myUid,to:this.friend.uid,msg:t}).then(function(t){var r=t.data;r&&(e.getmsgoto(),p("send-private-chat",n,e.friend.uid))})}},autoBottom:function(){window.scrollTo({top:window.screen.height+9999,behavior:"smooth"})},goBack:function(){this.$router.push({name:"home"})}})},J=V,W=(n("3bb5"),Object(O["a"])(J,z,L,!1,null,null,null)),G=W.exports,H=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("div",{staticClass:"nav-top"},[n("p",{staticClass:"nav-p-t"},[e._v("\n            欢迎您"),n("span",[e._v(e._s(e.title))])]),n("p",{staticClass:"nav-p",on:{click:e.exit}},[n("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949"},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}})],1)]),"friends"===e.tabName?n("div",{staticClass:"content-box"},e._l(e.friends,function(t){return n("div",{key:t.uid,staticClass:"flex",on:{click:function(n){return e.getChat(t)}}},[n("el-badge",{staticClass:"item",attrs:{hidden:e.getNum(t.uid),"is-dot":""}},[n("el-avatar",{attrs:{shape:"square",size:50,src:t.avatar}})],1),n("p",{staticClass:"flex1"},[e._v(e._s(t.name))]),e.onlineFn(t.uid)?n("p",{staticClass:"font-grenn"},[e._v("在线")]):n("p",{staticClass:"font-red"},[e._v("离线")])],1)}),0):e._e(),"xxx"===e.tabName?n("div",[e._v("\n        ...开发中\n    ")]):e._e(),n("div",{staticClass:"nav-bottom"},e._l(e.item,function(t,r){return n("p",{key:r,staticClass:"nav-p",class:{active:t.active},on:{click:function(n){return e.tabSelect(r,t.tabName)}}},[n("i",{class:t.icon}),e._v(e._s(t.value)+"\n        ")])}),0)])},K=[];n("6762"),n("2fdb");function Q(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function X(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Q(n,!0).forEach(function(t){Object(i["a"])(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Q(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var Y=[{value:"我的好友",active:!0,icon:"el-icon-user-solid",tabName:"friends"},{value:"待开发",active:!1,icon:"el-icon-upload",tabName:"xxx"}],Z={name:"home",data:function(){return{item:Object.assign([],Y),tabName:"friends",value:"",onlineFriends:[],uid:window.localStorage.uid,title:window.localStorage.name}},computed:{friends:function(){return this.$store.state.friends}},created:function(){p("online",this.uid),this.getFriends({uid:this.uid}),this.getWhoOnline()},methods:X({},Object(g["b"])(["getFriends"]),{getNum:function(e){var t=this.uid+"-"+e,n=this.getStroage(t);return!n},getWhoOnline:function(){var e=this;m("/whoOnline",{uid:this.uid}).then(function(t){var n=t.data;e.onlineFriends=n})},exit:function(){["avatar","name","uid"].forEach(function(e){window.localStorage.removeItem(e)}),p("offline",this.uid),this.$router.push({name:"login"})},tabSelect:function(e,t){this.item.forEach(function(t,n){t.active=n===e}),this.tabName=t},getChat:function(e){this.$router.push({name:"chat",params:e})},onlineFn:function(e){return this.onlineFriends.includes(e)}})},ee=Z,te=(n("de16"),Object(O["a"])(ee,H,K,!1,null,null,null)),ne=te.exports;r["default"].use(x["a"]);var re=new x["a"]({mode:"hash",routes:[{path:"/",name:"index",redirect:{name:"login"}},{path:"/login",name:"login",component:E},{path:"/register",name:"register",component:I},{path:"/home",name:"home",component:ne},{path:"/chat",name:"chat",component:G}]});re.beforeEach(function(e,t,n){window.localStorage.uid?"chat"==e.name&&e.params.uid?(n(),setTimeout(function(){window.scrollTo({top:window.screen.height+9999,behavior:"smooth"})},500)):"home"==e.name?n():n({name:"home"}):"login"==e.name||"register"==e.name?n():n({name:"login"})});var ae=re,oe=(n("96cf"),n("3b8d"));r["default"].use(g["a"]);var ie=[],se=[],ce=new g["a"].Store({state:{friends:se,shouldShowMsg:ie},mutations:{changeFriends:function(e,t){e.friends=Object.assign([],t)},changeShouldShowMsg:function(e,t){Array.isArray(t)?e.shouldShowMsg=Object.assign([],t):e.shouldShowMsg.push(t)}},actions:{getFriends:function(){var e=Object(oe["a"])(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:m("/getuser",{uid:n.uid}).then(function(e){t.commit("changeFriends",e.data)});case 1:case"end":return e.stop()}},e)}));function t(t,n){return e.apply(this,arguments)}return t}(),getShouldShowMsg:function(){var e=Object(oe["a"])(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:m("/getmsgoto",{uid1:n.uid1,uid2:n.uid2}).then(function(e){t.commit("changeShouldShowMsg",e.data)});case 1:case"end":return e.stop()}},e)}));function t(t,n){return e.apply(this,arguments)}return t}()}}),ue=(n("be4f"),n("450d"),n("896a")),le=n.n(ue),fe=(n("0fb7"),n("f529")),de=n.n(fe),me=(n("e960"),n("b35b")),pe=n.n(me),he=(n("e2f3"),n("06f9")),ge=n.n(he),ve=(n("f225"),n("89a9")),be=n.n(ve),we=(n("b5d8"),n("f494")),ye=n.n(we),Oe=(n("fe07"),n("6ac5")),Se=n.n(Oe),je=(n("eca7"),n("3787")),xe=n.n(je),_e=(n("425f"),n("4105")),Pe=n.n(_e),ke=(n("186a"),n("301f")),$e=n.n(ke),Ce=(n("96dc"),n("9cea")),Me=n.n(Ce),Te=(n("920a"),n("4f0c")),Ee=n.n(Te),Ne=(n("10cb"),n("f3ad")),Ae=n.n(Ne),De=(n("1951"),n("eedf")),Fe=n.n(De);r["default"].use(Fe.a),r["default"].use(Ae.a),r["default"].use(Ee.a),r["default"].use(Me.a),r["default"].use($e.a),r["default"].use(Pe.a),r["default"].use(xe.a),r["default"].use(Se.a),r["default"].use(ye.a),r["default"].use(be.a),r["default"].use(ge.a),r["default"].use(pe.a),r["default"].prototype.$message=de.a,r["default"].use(le.a.directive),r["default"].config.productionTip=!1,r["default"].prototype.service=$,r["default"].prototype.saveStroage=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};for(var t in e)window.localStorage[t]=e[t]},r["default"].prototype.getStroage=function(e){return window.localStorage[e]},new r["default"]({router:ae,store:ce,render:function(e){return e(j)}}).$mount("#app")},ddb4:function(e,t,n){"use strict";var r=n("41a6"),a=n.n(r);a.a},de16:function(e,t,n){"use strict";var r=n("f3e7"),a=n.n(r);a.a},f3e7:function(e,t,n){}});
//# sourceMappingURL=app.d1d54d6d.js.map